package JKioskView;

import java.util.*;
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;
import javax.swing.event.*;


public class MainWindow extends JFrame
{
	// private fields
	private Container c;
	private JPanel menuPanel;
	private JPanel pagePanel;
	
	Map<String, JPanel> windowPanels = new HashMap<String, JPanel>();
	
	public MainWindow()
	{
		// Initialize MainWindow Property
		this.setTitle("JKiosk");
		this.setSize(600, 500);
		this.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
		this.setLayout(new BorderLayout());
		
		// MainWindow Container
		c = this.getContentPane();
		
		
		// 
		menuPanel = new MenuPanel();
		pagePanel = new PagePanel();
		
		c.add(menuPanel, BorderLayout.NORTH);
		c.add(pagePanel);
		
		// Make Pages
		windowPanels.put("home", (JPanel)new HomePanel());
		windowPanels.put("menu", (JPanel)new OrderPanel());
		
		//pagePanel.removeNotify();
		
		JPanel temp = pagePanel; // 삭제할 객체 저장
		
		
		DeletePanel(pagePanel); // 컨텐트 페인에서 삭제
		pagePanel = windowPanels.get("home"); //가져올 데이터불러오기
		c.add(pagePanel); // 가져온데이터 컨텐트페인에 등록
		
		
		c.remove(pagePanel); // 객체가 삭제됬는지 확인 하기위해 다시삭제
		pagePanel = temp; // 불러옴
		c.add(pagePanel); // 다시로
		
		this.revalidate();
		this.repaint();
		//c.add();
		
		
		
		
		// Show Window
		this.setVisible(true);
	}
	
	public void Navigation(String pageName) throws Exception
	{
		if (this.windowPanels.containsKey(pageName))
		{
			this.pagePanel = (JPanel)this.windowPanels.get(pageName);
			//this.c.removeAll();
			//this.c.add(targetPage);
			this.revalidate();
			this.repaint();
		}
		else
		{
			throw new Exception("해당하는 페이지\"" + pageName + "\"가 존재하지 않습니다.");
		}
	}
	
	public void ResetPage(String pageName) throws Exception
	{
		if (this.windowPanels.containsKey(pageName))
		{
			JPanel targetPage = this.windowPanels.get(pageName);
			DeletePage(targetPage);
			
			Class<? extends JPanel> temp = targetPage.getClass();
			throw new Exception("Not Implemented!");
		}
	}
	
	// 컴포넌트에 등록되어있으면 삭제하고, 정리합니다.
	private void DeletePage(JPanel targetPage)
	{
		//Dispose old JPanel
		if (c.getComponentZOrder(targetPage) != -1) // targetPage is null or parent is not c has return -1
			c.remove(targetPage);
		Component comp = SwingUtilities.getRoot(targetPage);
	    ((Window) comp).dispose();
	}
	
	class MenuPanel extends JPanel
	{
		public MenuPanel()
		{
			this.setBackground(Color.cyan);
		}
	}
	
	class PagePanel extends JPanel
	{
		public PagePanel()
		{
			this.setBackground(Color.magenta);			
		}
	}
}
